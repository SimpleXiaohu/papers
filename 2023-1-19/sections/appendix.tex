\section{Encoding Other Operations to CEFA} \label{appendix:cefa}

\subsection{Concatenation}\label{subsec:con}
Given two CEFAs $\aut_1 = (Q_1, \Sigma, \delta_1, q_{I_1}, F_1, R_1, \theta_1)$ and $\aut_2 = (Q_2, \Sigma, \delta_2, q_{I_2}, F_2, R_2, \theta_2)$ with $R_1\cap R_2= \emptyset$ and $|R_1|=m,|R_2|=n$, the concatenation of them is defined as $\aut_{\cdot}=(Q_1\cup Q_2, \Sigma, \delta', q_{I_1}, F_2, R_1\cdot R_2, \theta_1\wedge\theta_2)$ where $\delta'$ is composed by
\begin{itemize}
  \item $q_1\xrightarrow[\myvec{v_1}\cdot 0_n]{a} q_1'$ for each transition $q_1\xrightarrow[\myvec{v_1}]{a} q_1' \in \delta_1$,
  \item $q_2\xrightarrow[0_m\cdot\myvec{v_2}]{a} q_2'$ for each transition $q_2\xrightarrow[\myvec{v_2}]{a} q_2' \in \delta_2$,
  \item and $q_1\xrightarrow[0_{m+n}]{\epsilon} q_{I_2}$ for each $q_1\in F_1$.
\end{itemize}
\begin{figure}[h]
  \centering
  \begin{subfigure}[h]{0.3\textwidth}
    \begin{tikzpicture}[shorten >=1pt,node distance=1cm,on grid,>={Stealth[round]},
      every state/.style={draw=blue!50,minimum size = 0.1cm}, initial text=]
      \node[state, initial]   (q_0) {};
      \node[state, accepting]    (q_1) [right=of q_0] {};
      \path[->] (q_0) edge [bend right] node [below] {$a/\myvec{v_1}$} (q_1);
      \node [fit=(q_0) (q_1)] {$\cdots$};
    \end{tikzpicture}
    \caption{The CEFA $\aut_1$}
  \end{subfigure}
  \begin{subfigure}[h]{0.3\textwidth}
    \begin{tikzpicture}[shorten >=1pt,node distance=1cm,on grid,>={Stealth[round]},
      every state/.style={draw=blue!50,minimum size = 0.1cm}, initial text=]
      \node[state, initial]   (q_0) {};
      \node[state, accepting]    (q_1) [right=of q_0] {};
      \path[->] (q_0) edge [bend right] node [below] {$a/\myvec{v_2}$} (q_1);
      \node [fit=(q_0) (q_1)] {$\cdots$};
    \end{tikzpicture}
    \caption{The CEFA $\aut_2$}
  \end{subfigure}
  \begin{subfigure}[h]{0.3\textwidth}
    \centering
    \begin{tikzpicture}[shorten >=1pt,node distance=1cm,on grid,>={Stealth[round]},
      every state/.style={draw=blue!50,minimum size = 0.1cm}, initial text=]
      \node[state, initial]   (q_0) {};
      \node[state]    (q_1) [right=of q_0] {};
      \node[state]    (q_2) [right=of q_1] {};
      \node[state, accepting]    (q_3) [right=of q_2] {};
      \path[->]
      (q_0) edge [bend right] node [below] {$a/\myvec{v_1}\cdot \red{0_n}$} (q_1)
      (q_1) edge node [above] {$\epsilon/\red{0_{m+n}}$} (q_2)
      (q_2) edge [bend right] node [below] {$a/\red{0_m}\cdot \myvec{v_2}$} (q_3);
      \node [fit=(q_0) (q_1)] {$\cdots$};
      \node [fit=(q_2) (q_3)] {$\cdots$};
    \end{tikzpicture}
    \caption{The concatenation of $\aut_1$ and $\aut_2$}
  \end{subfigure}
  \caption{Concatenation}
  \label{fig:con}
\end{figure}
The concatenation of two CEFAs is similar to that of two NFAs, except that the registers and their updates are also concatenated.

Figure \ref{fig:con} outlines the vector change on transitions when concatenating two CEFA. Without losing information, $\aut_{\cdot}$ contains all registers in $\aut_1$ and $\aut_2$. Furthermore, $\aut_{\cdot}$ update registers' value of $\aut_1$ and $\aut_2$ separately: $\aut_{\cdot}$ only update registers of $R_1$ on the transitions of $\aut_1$ and update registers of $R_2$ on the transition of $\aut_2$. $\theta'$ is the conjunction of $\theta_1$ and $\theta_2$ to make sure all linear constraints in $\aut_1$ and $\aut_2$ are satisfiable.
\subsection{Intersection}\label{subsec:inter}
Given two CEFAs $\aut_1 = (Q_1, \Sigma, \delta_1, q_{I_1}, F_1, R_1, \theta_1)$ and $\aut_2 = (Q_2, \Sigma, \delta_2, q_{I_2}, F_2, R_2, \theta_2)$ with $R_1\cap R_2 = \emptyset$, the intersection of them is defined as $\aut_{\times} = (Q_1\times Q_2, \Sigma, \delta', q_{I_1}\times q_{I_2}, F_1\times F_2, R_1\cdot R_2, \theta_1\wedge \theta_2)$ where $\delta'$ is composed by
\begin{itemize}
  \item transitions $(q_1,q_2)\xrightarrow[\myvec{v_1}\cdot\myvec{v_2}]{a} (q_1',q_2')$ if transition $q_1\xrightarrow[\myvec{v_1}]{a}q_1'$ and transition $q_2\xrightarrow[\myvec{v_2}]{a}q_2'$ exist individually in  $\delta_1$ and $\delta_2$.
\end{itemize}
\begin{figure}[h]
  \centering
  \begin{subfigure}[h]{0.30\textwidth}
    \begin{tikzpicture}[shorten >=1pt,node distance=2cm,on grid,>={Stealth[round]},
      % every fit/.style={draw,minimum height=2cm,minimum width=3.5cm,dashed},
      every state/.style={draw=blue!50,minimum size = 0.1cm}, initial text=]
      \node[state, initial]   (q_0) {};
      \node[state, accepting]    (q_1) [right=of q_0] {};
      \path[->]
      (q_0) edge [bend right] node [below] {$a$/$\myvec{v_1}$} (q_1)
      (q_0) edge [bend left] node [above] {$b$/$\myvec{v_1}$} (q_1);
      \node [fit=(q_0) (q_1)] {$\cdots$};
    \end{tikzpicture}
    \caption{The CEFA $\aut_1$}
  \end{subfigure}
  \begin{subfigure}[h]{0.30\textwidth}
    \begin{tikzpicture}[shorten >=1pt,node distance=2cm,on grid,>={Stealth[round]},
      % every fit/.style={draw,minimum height=2cm,minimum width=3.5cm,dashed},
      every state/.style={draw=blue!50,minimum size = 0.1cm}, initial text=]
      \node[state, initial]   (q_0) {};
      \node[state, accepting]    (q_1) [right=of q_0] {};
      \path[->]
      (q_0) edge [bend right] node [below] {$a$/$\myvec{v_2}$} (q_1)
      (q_0) edge [bend left] node [above] {$c$/$\myvec{v_2}$} (q_1);
      \node [fit=(q_0) (q_1)] {$\cdots$};
    \end{tikzpicture}
    \caption{The CEFA $\aut_2$}
  \end{subfigure}
  \begin{subfigure}[h]{0.3\textwidth}
    \begin{tikzpicture}[shorten >=1pt,node distance=2cm,on grid,>={Stealth[round]},
      % every fit/.style={draw,minimum height=2cm,minimum width=3.5cm,dashed},
      every state/.style={draw=blue!50,minimum size = 0.1cm}, initial text=]
      \node[state, initial]   (q_0) {};
      \node[state, accepting]    (q_3) [right=of q_0] {};
      \path[->]
      (q_0) edge [bend right] node [below] {$a$/\red{$\myvec{v_1}\cdot \myvec{v_2}$}} (q_3);
      \node [fit=(q_0) (q_3)] {$\cdots$};
    \end{tikzpicture}
    \caption{The intersection of $\aut_1$ and $\aut_2$}
  \end{subfigure}
  \caption{Intersection}
  \label{fig:inter}
\end{figure}
The intersection of two CEFAs is similar to that of NFA, except that the vectors and linear arithmetic are also intersected.

\subsection{Union}\label{subsec:union}
Given two CEFAs $\aut_1 = (Q_1, \Sigma, \delta_1, q_{I_1}, F_1, R_1, \theta_1)$ and $\aut_2 = (Q_2, \Sigma, \delta_2, q_{I_2}, F_2, R_2, \theta_2)$ with $R_1\cap R_2 = \emptyset$ and $|R_1|=m,|R_2|=n$, the union of them is defined as $\aut_{+} = (Q_1\cup Q_2\cup\{q_0\}, \Sigma, \delta', \{q_I\}, F_1\cup F_2, R_1\cdot R_2\cdot (r_1, r_2), \theta')$ where $\delta'$ is composed by
\begin{itemize}
  \item transitions $q_I\xrightarrow[0_{m+n}\cdot(1,0)]{\epsilon}q_1$ for all $q_1\in I_1$,
  \item transitions $q_I\xrightarrow[0_{m+n}\cdot(0,1)]{\epsilon}q_2$ for all $q_2\in I_2$,
  \item transitions $q_1\xrightarrow[\myvec{v_1}0_{n+2}]{a} q_1'$ for all $q_1\xrightarrow[\myvec{v_1}]{a} q_1'\in \delta_1$,
  \item transitions $q_2\xrightarrow[0_m\myvec{v_2}0_2]{a} q_2'$ for all $q_2\xrightarrow[\myvec{v_2}]{a} q_2'\in \delta_2$.
\end{itemize}
$r_1$ and $r_2$ are new registers to determine which automaton to run. $q_I$ is a new state where $q_I\not\in Q_1$ and $q_I\not\in Q_2$. Assume that basic determining formula $\theta$  is $(r_1>0\wedge\theta_1)\vee(r_2>0\wedge\theta_2)$, $\theta'$ is constructed differently in four cases:
\begin{itemize}
  \item $q_{I_1}\in F\wedge q_{I_2}\in F$: $\theta'$ = $\theta $;
  \item $q_{I_1}\in F\wedge q_{I_2}\not\in F$: $\theta'$ = $\theta \vee (r_1==0\wedge r_2==0\wedge\theta_1)$;
  \item $q_{I_1}\not\in F\wedge q_{I_2}\in F$: $\theta'$ = $\theta \vee (r_1==0\wedge r_2==0\wedge\theta_2)$;
  \item $q_{I_1}\in F\wedge q_{I_2}\in F$: $\theta'$ = $\theta \vee (r_1==0\wedge r_2==0\wedge(\theta_1\vee\theta_2))$;
\end{itemize}

\begin{figure}[h]
  \centering
  \begin{subfigure}{0.20\textwidth}
    \begin{tikzpicture}[shorten >=1pt,node distance=1cm,on grid,>={Stealth[round]},
      % every fit/.style={draw,minimum height=2cm,minimum width=3.5cm,dashed},
      every state/.style={draw=blue!50,minimum size = 0.1cm}, initial text=]
      \node[state, initial]   (q_0) {};
      \node[state, accepting]    (q_1) [right=of q_0] {};
      \path[->]
      (q_0) edge [bend left] node [above] {$a$/$\myvec{v_1}$} (q_1);
      \node [fit=(q_0) (q_1)] {$\cdots$};
    \end{tikzpicture}
    \caption{The CEFA $\aut_1$}
  \end{subfigure}
  \begin{subfigure}{0.20\textwidth}
    \begin{tikzpicture}[shorten >=1pt,node distance=1cm,on grid,>={Stealth[round]},
      % every fit/.style={draw,minimum height=2cm,minimum width=3.5cm,dashed},
      every state/.style={draw=blue!50,minimum size = 0.1cm}, initial text=]
      \node[state, initial]   (q_0) {};
      \node[state, accepting]    (q_1) [right=of q_0] {};
      \path[->]
      (q_0) edge [bend right] node [below] {$a$/$\myvec{v_2}$} (q_1);
      \node [fit=(q_0) (q_1)] {$\cdots$};
    \end{tikzpicture}
    \caption{The CEFA $\aut_2$}
  \end{subfigure}
  \begin{subfigure}{0.4\textwidth}
    \centering
    \begin{tikzpicture}[shorten >=1pt,node distance=1cm,on grid,>={Stealth[round]},
      % every fit/.style={draw,minimum height=2cm,minimum width=3.5cm,dashed},
      every state/.style={draw=blue!50,minimum size = 0.1cm}, initial text=]
      \node[state, initial]   (q_0) {};
      \node[state]   (q_1) [above right=of q_0] {};
      \node[state, accepting]   (q_1') [right=of q_1] {};
      \node[state]   (q_2) [below right=of q_0] {};
      \node[state, accepting]   (q_2') [right=of q_2] {};
      \path[->]
      (q_0) edge node [left] {$\epsilon/\red{0_{m+n}\cdot(1,0)}$} (q_1)
      (q_0) edge node [left] {$\epsilon/\red{0_{m+n}\cdot(0,1)}$} (q_2)
      (q_1) edge [bend left] node [above] {$a$/\red{$\myvec{v_1}\cdot 0_{n+2}$}} (q_1')
      (q_2) edge [bend right] node [below] {$a$/\red{$0_m\cdot \myvec{v_2}\cdot 0_2$}} (q_2');
      \node [fit=(q_1) (q_1')] {$\cdots$};
      \node [fit=(q_2) (q_2')] {$\cdots$};
    \end{tikzpicture}
    \caption{The union of $\aut_1$ and $\aut_2$}
  \end{subfigure}
  \caption{Union}
  \label{fig:union}
\end{figure}
To simulate the semantics of the union, we add transitions from $q_I$ to initial states of $\aut_1$ and $\aut_2$ to choose one automaton randomly. $r_1 > 0$ indicates we choose $\aut_1$ to run while $r_2 > 0$ indicates that we choose $\aut_2$ to run. The basic determining formula $(r_1>0\wedge\theta_1)\vee(r_2>0\wedge\theta_2)$ means that the accepting condition of chosen automaton should be satisfied. Furthermore, the accepting run may stop at the new initial state $q_I$ with $\mathcal{V}(r_1) = 0, \mathcal{V}(r_2)=0$ when some initial states of two given CEFAs are accepting. More precise, the accepting condition contains $r_1==0\wedge r_2==0\wedge\theta_1$ if $q_{I_1}$ is accepting and contains $r_1==0\wedge r_2==0\wedge\theta_2$ if $q_{I_2}$ is accepting.
\subsection{Complement} \label{subsec:complement}
Given an CEFA $\aut = (Q, \Sigma, q_{I}, F, \delta, \emptyset, true)$, the complement is defined as the CEFA $\aut_c = (Q', \Sigma, q_{I}, F', \delta', \emptyset, true)$ where $(Q', \Sigma, q_{I}, F', \delta')$ is the complement of NFA $(Q, \Sigma, q_{I}, F, \delta)$.
\subsection{Closure} \label{subsec:closure}
Given an CEFA $\aut = (Q, \Sigma, q_{I}, F, \delta, \emptyset, true)$, the complement is defined as the CEFA $\aut_c = (Q', \Sigma, q_{I}, F', \delta', \emptyset, true)$ where $(Q', \Sigma, q_{I}', F', \delta')$ is the closure of NFA $(Q, \Sigma, q_{I}', F, \delta)$.

\section{Detailed Evaluation} \label{appendix:experiential_results}
The detailed results for the \textbf{AutomatArk} benchmark are presented in Figure \ref{fig:cactus_automatrk} and Table \ref{tab:results_automatrk}. OstrichCEA solved the most \emph{unsat} instances. Z3str3RE solved the most \emph{sat} instances. Ostrich solved the greatest number of instances, while Z3str3RE used the least time with timeouts.\newline
The detailed results for the \textbf{Redos} benchmark are presented in Figure \ref{fig:cactus_redos} and Table \ref{tab:results_redos}. OstrichCEA solved the most instances on both tracks of \emph{sat} and \emph{unsat}. Including timeouts, OstrichCEA is \textbf{4.4}\mult{} faster than CVC5, \textbf{3.74}\mult{} faster than Ostrich, \textbf{2.09}\mult{} faster than Z3str3, \textbf{5.40}\mult{} faster than Z3seq, \textbf{2.49}\mult{} faster than Z3-Trau and close to Z3str3RE with \%20 speed loss. \newline 
The detailed results for the \textbf{RegexLib} benchmark are presented in Figure \ref{fig:cactus_regexlib} and Table \ref{tab:results_regexlib}. Ostrich solved the most \emph{unsat} instances. OstrichCEA solved the most \emph{sat} instances. In total, OstrichCEA solved the greatest number of instances and was the solver with medium speed. \newline
The detailed results for the \textbf{StackOverflow} benchmark are presented in Figure \ref{fig:cactus_stackoverflow} and Table \ref{tab:results_stackoverflow}. OstrichCEA solved the most instances on both tracks of \emph{sat} and \emph{unsat} and was the faster solver.\newline Including timeouts, OstrichCEA is \textbf{3.98}\mult{} faster than CVC5, \textbf{2.63}\mult{} faster than Ostrich, \textbf{2.19}\mult{} faster than Z3str3, \textbf{1.59}\mult{} faster than Z3seq, \textbf{1.28}\mult{} faster than CVC5 and \textbf{1.47}\mult{} to Z3str3RE. \newline
\begin{figure}
  \centering
  \subimport{figures}{cactus_plot_automatark.tex}
  \caption{The plot of a cactus graph depicting a comprehensive evaluation of the performance of the AutomatArk benchmark.}
  \label{fig:cactus_automatrk}
\end{figure}
\begin{table}
  \subimport{tables}{table_automatark.tex}
  \caption{Detailed results for the AutomatArk benchmark.}
  \label{tab:results_automatrk}
\end{table}

\begin{figure}
  \subimport{figures}{cactus_plot_redos.tex}
  \caption{The plot of a cactus graph depicting a comprehensive evaluation of the performance of the ReDos benchmark.}
  \label{fig:cactus_redos}
\end{figure}
\begin{table}
  \subimport{tables}{table_redos.tex}
  \caption{Detailed results for the ReDos benchmark.}
  \label{tab:results_redos}
\end{table}

\begin{figure}
  \subimport{figures}{cactus_plot_regexlib.tex}
  \caption{The plot of a cactus graph depicting a comprehensive evaluation of the performance of the RegexLib benchmark.}
  \label{fig:cactus_regexlib}
\end{figure}
\begin{table}
  \subimport{tables}{table_regexlib.tex}
  \caption{Detailed results for the RegexLib benchmark.}
  \label{tab:results_regexlib}
\end{table}

\begin{figure}
  \subimport{figures/}{cactus_plot_stackoverflow.tex}
  \caption{The plot of a cactus graph depicting a comprehensive evaluation of the performance of the StackOverflow benchmark.}
  \label{fig:cactus_stackoverflow}
\end{figure}
\begin{table}
  \subimport{tables}{table_stackoverflow.tex}
  \caption{Detailed results for the StackOverflow benchmark.}
  \label{tab:results_stackoverflow}
\end{table}
